# ReflectiveDataWebEditor
Runtime generated React based Java object editor

## Context
This code forms the basis for configuring a test system. 
The configuration to be specified is defined as a number of Java classes, with
extensive use of Enum to specify the acceptable values. The goal is to expose those
classes on a HTML page in a generic manner, based solely on the Java code. 

The UI need not be attractive since it is merely an engineering tool. 

## Components

### react-json
[This](https://github.com/arqex/react-json) React component implements a generic editor of a Javascript object.
It accepts metadata (called _settings_) to customize the UI and provide information beyond what appears in the
target object. This metadata is used to provide select fields for the Java Enum values.

### GSon
[This](https://github.com/google/gson) provides reflection based serialization between Java and JSON.

### Akka HTTP
[This](http://doc.akka.io/docs/akka-stream-and-http-experimental/1.0/) implements the web server with which the React
SPA will interact.

In isolation, this choice might be considered overkill and inappropriate given the experimental label. In this
particular case, its functionality is required by the larger system from this code was extracted. 
A standalone implementation might want to select a different implementation. 

### Scala
Scala is not mandatory for a standalone system but is the only implementation language for the larger system.
 
The configuration implementation uses Java since the system under test is written in Java and the test system
references its source code for these common classes. 

## Implementation

### ReactJsonGenerator.scala 
Generates the JSON needed to initialize and configure the react-json editor:

* The instance is directly mapped to JSON using GSon. 
* Java reflection is used to walk the associated class and extract the values specified by any Java Enums. 
A JSON setting instance is created to pass these values to the editor.

### WebServer.scala

* Serves up the files that form the UI
* Defines initial values for the Java classes to be editted
* Serves up the JSON generated by ReactJsonGenerator
* Accepts POST from the editor and deserializes the JSON into the corresponding Java class.
This example simply prints the class to stdout.

### JsonUpdate.js
Implements a React component that:

* Embeds the react-js editor component
* Performs Ajax call on _mount_ to fetch the JSON needed to instantiate the editor component
* Posts new state of the editor to server whenever a field changes
 
Note that editor component will rerender when the data changes but not when the settings change.
It is thus necessary to initially render a placeholder and only render the editor once the settings are available.

This implementation submits the complete object whenever any field changes, which was appropriate
for this problem domain. Other implementations might wish to use an explicit submit button.

## To run

* Checkout repository
* Install npm
* Install sbt
* in one window run
    * npm install
    * npm start
* in second window run
    * sbt run
* Point browser at http://hostname:9090/update.html
